import os
from core.logger import get_logger

logger = get_logger("pdf_malware")

SUSPICIOUS_KEYWORDS = [
    b"/JavaScript",
    b"/JS",
    b"/Launch",
    b"/EmbeddedFile",
    b"/OpenAction",
    b"/AA",
    b"eval(",
    b"unescape(",
    b"this.exportDataObject"
]

def scan_pdf(path):
    if not os.path.exists(path):
        logger.error(f"PDF file not found: {path}")
        raise FileNotFoundError(f"PDF file not found: {path}")

    logger.info(f"Starting static PDF scan: {path}")
    findings = []

    with open(path, "rb") as f:
        content = f.read()

    for keyword in SUSPICIOUS_KEYWORDS:
        if keyword in content:
            decoded = keyword.decode(errors="ignore")
            findings.append(decoded)
            logger.warning(f"Suspicious keyword found: {decoded}")

    return findings

